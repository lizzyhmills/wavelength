
  <div data-controller="comments">
    <div class="post <%= post.user == current_user ? "current-user-post" : "other-user-post" %>" data-controller="play-button">
      <div class="post-top d-flex">
      <%= cl_image_tag post.user.photo.key, class: "avatar-bordered" %>
        <%= post.user.username.capitalize %>  <audio data-play-button-target="audio" controls src="<%= post.genre %>" class="mx-2 d-none"></audio> <br>
      </div>
      <div class="song-info">
        <div class="position-relative mb-3">
          <div class="play-song">
             <div class=" ms-2" data-action="click->play-button#play" ><i class="fa-solid fa-play" style="color: #f5f5f5;"></i></div>
             <img src="<%= post.image_url %>" alt="" class="album-artwork">
          </div>
          <div class="offset-song-icons d-flex justify-content-start w-100" style="gap: 1rem;">
            <% if post.likes.where(user: current_user).any? %>
              <%= link_to post_like_path(post, post.likes.where(user: current_user).first), data: {turbo_method: :delete} do %>
                <i class="offset-icon fa-solid fa-heart text-danger" id="heart-icon"></i>
              <% end %>
            <% else %>
              <%= form_with(url: post_likes_path(post), method: :post, local: true, html: { class: "bookmark-form" }) do |form| %>
                <button type="submit" class="bookmark-button">
                  <i class="offset-icon fa-solid fa-heart" id="heart-icon"></i>
                </button>
              <% end %>
            <% end %>
            <span><%= post.likes.count %></span>
            <i class="offset-icon fa-solid fa-comment" id="message-icon" data-action="click->comments#toggle"></i>
            <% if post.favourite_posts.where(user: current_user).any? %>
                <%= link_to post_favourite_post_path(post, post.favourite_posts.where(user: current_user).first), style:"margin-left: auto;", data: {turbo_method: :delete} do %>
                <i class="offset-icon fa-solid fa-bookmark blue" ></i>
              <% end %>

            <% else %>
              <%= form_with(url: post_favourite_posts_path(post), method: :post, local: true, html: { class: "bookmark-form", style: "margin-left: auto;" }) do |form| %>
                    <button type="submit" class="bookmark-button">
                    <i class="offset-icon fa-solid fa-bookmark" id="save-icon" style="margin-left: auto;"></i>
                    </button>
              <% end %>
            <% end %>
          </div>
        </div>
        <div class="d-flex justify-content-between">
          <h3><%= post.song_name.slice(0, 20) %></h3>
          <% if current_user == post.user %>
            <%= link_to edit_post_path(post), id: "edit-icon" do %>
              <i class="fa-solid fa-pen"></i>
            <% end %>
          <% end %>
        </div>

        <h4><%= post.artist %></h4>
        <h5><%= post.caption.slice(0, 40) %><%= post.caption.length > 40 ? "..." : "" %></h5><br>
      </div>
    </div>
      <%= render 'shared/comment',  post: post %>
</div>

<style>

  .play-song{
  width:100%;

    .fa-solid {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size:40px;
    padding: 66px;
 filter: drop-shadow(0 0 0.80rem var(--BACKGROUND-SECONDARY-PINK));
    }
  }


</style>
